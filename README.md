# Satellite Image Inpainting with UNet

This project demonstrates how to apply a **UNet-based neural network** to the **image inpainting** problem using **satellite images** from the [EuroSAT](https://www.tensorflow.org/datasets/catalog/eurosat) dataset. The model learns to reconstruct missing or corrupted regions in satellite images using synthetic line masks.

---
  **University Project â€“ Machine Learning @ UNIBO**  
> This repository contains the final assignment for the **Machine Learning course** at the **University of Bologna (UNIBO)**.  
> The project explores a deep learning approach to solve the problem of **image inpainting** using satellite imagery and a custom **UNet architecture**.  
>  
>  **Deadline**: within one week from assignment date.

## Project Overview

- **Task**: Image inpainting on RGB satellite images (64x64 pixels).
- **Architecture**: Custom **UNet** with 3 convolutional levels and a bottleneck.
- **Dataset**: [EuroSAT RGB](https://www.tensorflow.org/datasets/catalog/eurosat) via `tensorflow_datasets`.
- **Corruption strategy**: Synthetic vertical or oblique lines randomly applied to training images using OpenCV.
- **Loss function**: Mean Squared Error (MSE).
- **Evaluation**: Repeated MSE analysis to assess model stability and performance.

---

## Model Architecture

The network follows a simplified **UNet structure**:
- **Encoder**: 3 convolutional levels with downsampling.
- **Bottleneck**: Two 256-filter convolution layers.
- **Decoder**: Upsampling with skip connections.
- **Output**: 3-channel RGB image with `sigmoid` activation.

---

## Dataset Preparation

- **Train set**: First 20,000 samples (shuffled).
- **Validation set**: Last 2,000 samples from training split.
- **Test set**: Remaining 3,000 samples (skip first 17,000).

Images are normalized to `[0, 1]`, and synthetic binary **masks** are generated by drawing random vertical lines. The input to the network is a masked image; the target is the original image.

---

## Training Setup

```python
optimizer = Nadam(learning_rate=0.001)
loss = 'mean_squared_error'
metrics = ['mse']
epochs = 10
```

Training is performed using custom generators that dynamically corrupt input images.

---

## Evaluation Strategy

The model is evaluated across **10 independent runs**, each consisting of:
- 1,250 test samples
- 10 repetitions per run
- Computation of mean and standard deviation of MSE

This helps assess generalization and robustness.

---

## Results Visualization

The notebook includes a final section that:
- Displays original images
- Shows masked (input) images
- Presents reconstructed (inpainted) outputs

These visual comparisons demonstrate the model's performance qualitatively.

---

## File Structure

```
.
â”œâ”€â”€ Satellite_Image_Inpainting_UNet.ipynb
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt (recommended)
```

---

## How to Run

1. Clone the repository:
   ```bash
   git clone https://github.com/your-username/satellite-image-inpainting-unet.git
   cd satellite-image-inpainting-unet
   ```

2. (Optional) Create a virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # or .env\Scriptsctivate on Windows
   ```

3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

4. Launch the notebook:
   ```bash
   jupyter notebook
   ```

---

## Requirements

- Python 3.8+
- TensorFlow 2.x
- OpenCV
- NumPy
- Matplotlib
- TensorFlow Datasets

You can generate a `requirements.txt` with:

```bash
pip freeze > requirements.txt
```

---

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.

---

## ðŸ™Œ Acknowledgments

- [TensorFlow Datasets](https://www.tensorflow.org/datasets)
- [EuroSAT Dataset](https://github.com/phelber/eurosat)
